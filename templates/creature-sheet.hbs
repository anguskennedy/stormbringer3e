<link rel="stylesheet" href="systems/stormbringer3e/css/stormbringer.css">

<form class="stormbringer-sheet creature-sheet" autocomplete="off">
  <header class="creature-header">
    <img class="sheet-portrait creature-portrait" src="{{actor.img}}" data-edit="img" alt="{{actor.name}} portrait" />
    <div class="creature-header-fields">
      <label>Name:</label>
      <input type="text" name="name" value="{{actor.name}}" />
    </div>
  </header>

  <section class="creature-section creature-columns">
    <div class="creature-column creature-attributes">
      <h3>Attributes</h3>
      {{#each system.attributes as |v k|}}
        <div class="creature-attribute-row">
          <label class="attr-label" data-action="roll-attr" data-attr="{{k}}">{{k}}</label>
          <input type="number" class="attr-value" name="system.attributes.{{k}}" value="{{v}}" />
        </div>
      {{/each}}
    </div>

    <div class="creature-column creature-skills-column">
      <h3>Skills</h3>
      {{#if creatureSkills.length}}
        {{#each creatureSkills as |skill|}}
          <div class="skill-row flexrow">
            <label class="skill-roll" data-action="roll-skill" data-item-id="{{skill.id}}">{{skill.name}}</label>
            <span class="item-field-wrapper">
              <input type="number" value="{{skill.total}}" data-item-id="{{skill.id}}" data-field="system.base" data-bonus="0" data-base-bonus="0" class="item-field" />
              <span class="item-percent">%</span>
            </span>
          </div>
        {{/each}}
      {{else}}
        <div class="skill-row empty">No skills assigned.</div>
      {{/if}}
    </div>

    <div class="creature-column creature-defense">
      <h3>Defense</h3>
      <div class="creature-armor">
        <h4>Armor</h4>
        <div class="creature-armor-row">
          <input type="number" class="creature-armor-points" name="system.armour.protection" value="{{system.armour.protection}}" placeholder="2" min="0" />
          <span class="creature-armor-points-label">pt</span>
          <input type="text" class="creature-armor-name" name="system.armour.name" value="{{system.armour.name}}" placeholder="Hide" />
        </div>
      </div>
      <div class="creature-hp">
        <h4>Hit Points</h4>
        <div class="creature-hp-mode">
          <label for="creature-hp-mode-select">Mode</label>
          <select id="creature-hp-mode-select" name="system.resources.hp.mode" class="creature-hp-mode-select">
            {{#each creatureHpModes as |mode|}}
              <option value="{{mode.value}}" {{#if mode.selected}}selected{{/if}}>{{mode.label}}</option>
            {{/each}}
          </select>
          {{#if creatureHpIsCustom}}
            <label for="creature-hp-override" class="creature-hp-override-label">Max</label>
            <input type="number" id="creature-hp-override" class="creature-hp-override" name="system.resources.hp.override" value="{{system.resources.hp.override}}" min="1" />
          {{/if}}
        </div>
        <div class="creature-hp-row">
          <input type="number" class="hp-input" name="system.resources.hp.value" value="{{system.resources.hp.value}}" />
          <span class="hp-max">/ {{system.resources.hp.max}}</span>
        </div>
      </div>
    </div>
  </section>

  <section class="creature-section creature-arsenal">
    <div class="creature-weapons">
      <h3>Weapons</h3>
      <div class="creature-weapon-table">
        <div class="creature-weapon-row creature-weapon-header">
          <span>Weapon</span>
          <span>Attack</span>
          <span>Damage</span>
          <span>Parry</span>
          <span></span>
        </div>
        {{#each creatureWeapons as |weapon index|}}
          <div class="creature-weapon-row">
            <span class="creature-weapon-value">
              <input type="text" name="system.creatureWeapons.{{index}}.name" value="{{weapon.name}}" />
            </span>
            <span class="creature-weapon-value">
              <button type="button" class="weapon-roll" data-action="roll-creature-weapon" data-index="{{index}}" data-roll-type="attack" title="Roll Attack">ðŸŽ²</button>
              <input type="number" name="system.creatureWeapons.{{index}}.attack" value="{{weapon.attack}}" />
              <span class="item-percent">%</span>
            </span>
            <span class="creature-weapon-value">
              <button type="button" class="weapon-roll" data-action="roll-creature-weapon" data-index="{{index}}" data-roll-type="damage" title="Roll Damage">ðŸŽ²</button>
              <input type="text" name="system.creatureWeapons.{{index}}.damage" value="{{weapon.damage}}" class="creature-weapon-damage" />
            </span>
            <span class="creature-weapon-value">
              <button type="button" class="weapon-roll" data-action="roll-creature-weapon" data-index="{{index}}" data-roll-type="parry" title="Roll Parry">ðŸŽ²</button>
              <input type="number" name="system.creatureWeapons.{{index}}.parry" value="{{weapon.parry}}" />
              <span class="item-percent">%</span>
            </span>
            <button type="button" class="creature-weapon-remove" data-index="{{index}}" title="Remove">âœ•</button>
          </div>
        {{/each}}
        <div class="creature-weapon-row creature-weapon-row--new">
          <input type="text" name="system.creatureWeapons.{{creatureWeapons.length}}.name" placeholder="Weapon name" />
          <span class="creature-weapon-value">
            <span class="weapon-roll-placeholder">ðŸŽ²</span>
            <input type="number" name="system.creatureWeapons.{{creatureWeapons.length}}.attack" placeholder="0" />
            <span class="item-percent">%</span>
          </span>
          <span class="creature-weapon-value">
            <span class="weapon-roll-placeholder">ðŸŽ²</span>
            <input type="text" name="system.creatureWeapons.{{creatureWeapons.length}}.damage" placeholder="1d6" class="creature-weapon-damage" />
          </span>
          <span class="creature-weapon-value">
            <span class="weapon-roll-placeholder">ðŸŽ²</span>
            <input type="number" name="system.creatureWeapons.{{creatureWeapons.length}}.parry" placeholder="0" />
            <span class="item-percent">%</span>
          </span>
          <span></span>
        </div>
      </div>
    </div>
  </section>

  <section class="creature-section creature-description">
    <label>Description</label>
    <textarea class="creature-textarea" name="system.details.description">{{system.details.description}}</textarea>
  </section>

  <section class="creature-section creature-habitat">
    <label>Habitat</label>
    <textarea class="creature-textarea" name="system.details.habitat">{{system.details.habitat}}</textarea>
  </section>
</form>
